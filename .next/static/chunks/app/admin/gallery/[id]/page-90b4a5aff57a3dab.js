(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2031],{1449:(e,l,a)=>{"use strict";a.d(l,{Ob:()=>d,X1:()=>r,cV:()=>o,x3:()=>i,z0:()=>t});let s="http://localhost:8181/api",i=async(e,l,a,i)=>(await fetch(s+"/gallery?page=".concat(e,"&limit=").concat(l,"&sortColumn=").concat(a,"&sortOrder=").concat(i),{credentials:"include"})).json(),t=async e=>(await fetch("".concat(s,"/gallery/").concat(e),{credentials:"include"})).json(),r=async e=>{let l=new FormData;return l.append("type",e.type),l.append("order",e.order),"image"==e.type&&e.galleryPhoto&&e.galleryPhoto.length>0&&l.append("file",e.galleryPhoto[0]),"video"==e.type&&(e.galleryVideo&&e.galleryVideo.length>0&&l.append("video",e.galleryVideo[0]),e.galleryVideoPoster&&e.galleryVideoPoster.length>0&&l.append("videoPoster",e.galleryVideoPoster[0])),(await fetch("".concat(s,"/gallery/create"),{method:"POST",credentials:"include",body:l})).json()},d=async(e,l)=>{let a=new FormData;return a.append("type",l.type),a.append("order",l.order),console.log("-11->",l),"image"==l.type&&l.galleryPhoto&&l.galleryPhoto.length>0&&a.append("file",l.galleryPhoto[0]),"video"==l.type&&(l.galleryVideo&&l.galleryVideo.length>0&&a.append("video",l.galleryVideo[0]),l.galleryVideoPoster&&l.galleryVideoPoster.length>0&&a.append("videoPoster",l.galleryVideoPoster[0])),(await fetch("".concat(s,"/gallery/update/").concat(e),{method:"PUT",credentials:"include",body:a})).json()},o=async e=>(await fetch("".concat(s,"/gallery/delete/").concat(e),{method:"DELETE",credentials:"include"})).json()},1771:(e,l,a)=>{Promise.resolve().then(a.bind(a,6693))},6693:(e,l,a)=>{"use strict";a.r(l),a.d(l,{default:()=>h});var s=a(5155),i=a(2115),t=a(5695),r=a(8835),d=a(4751),o=a(5828),n=a(7478),c=a(1449),m=a(8772),u=a(5799);function h(){let[e,l]=(0,i.useState)(null),a=(0,t.useRouter)(),[h,g]=(0,i.useState)(null),[v,y]=(0,i.useState)(!0),[p,x]=(0,i.useState)(!1),[j,b]=(0,i.useState)(null),{id:N}=(0,t.useParams)();(0,i.useEffect)(()=>{(async()=>{try{y(!0);let e=await (0,c.z0)(N);g(e.data),b(null)}catch(e){b("Failed to fetch gallery data"),console.error(e)}finally{y(!1)}})()},[N]);let f=async e=>{try{x(!0),b(null),await (0,c.Ob)(N,e);let l=await (0,c.z0)(N);g(l.data),u.oR.success("Gallery image updated successfully."),a.push("/admin/gallery")}catch(e){b(e.message||"Failed to update gallery image"),console.error(e)}finally{x(!1)}};return((0,i.useEffect)(()=>{(0,r.E$)().then(e=>{e.error?a.push("/admin/login"):l(e)})},[]),v)?(0,s.jsx)("div",{children:(0,s.jsx)("div",{className:"d-flex justify-content-center my-5",children:(0,s.jsx)("div",{className:"spinner-border",role:"status",children:(0,s.jsx)("span",{className:"visually-hidden",children:"Loading..."})})})}):(0,s.jsxs)("div",{id:"wrapper",children:[(0,s.jsx)(d.A,{}),(0,s.jsx)("div",{id:"content-wrapper",className:"d-flex flex-column",children:(0,s.jsxs)("div",{id:"content",children:[(0,s.jsx)(n.A,{}),(0,s.jsxs)("div",{className:"container-fluid",children:[(0,s.jsx)("div",{className:"d-sm-flex align-items-center justify-content-between mb-4",children:(0,s.jsxs)("h1",{className:"h3",children:[" Edit Gallery: ",null==h?void 0:h.name]})}),(0,s.jsx)("div",{className:"row",children:(0,s.jsx)("div",{className:"col-xl-12 col-md-12 mb-12",children:(0,s.jsx)("div",{className:"card border-left-primary shadow h-100 py-2",children:(0,s.jsx)("div",{className:"card-body",children:(0,s.jsx)(m.A,{initialData:h,onSubmit:f,isSubmitting:p})})})})})]}),(0,s.jsx)(o.A,{})]})})]})}},8772:(e,l,a)=>{"use strict";a.d(l,{A:()=>c});var s=a(5155),i=a(2177),t=a(2115),r=a(2051),d=a(6874),o=a.n(d);let n="http://localhost:8181",c=e=>{var l,a,d,c,m,u,h,g,v,y;let{initialData:p,onSubmit:x,isSubmitting:j}=e,{register:b,handleSubmit:N,setError:f,control:P,reset:w,formState:{errors:V}}=(0,i.mN)({defaultValues:p||{type:"",galleryPhoto:null,galleryVideo:null,galleryVideoPoster:null,image:"",video:"",videoPoster:"",order:"0"}}),S=[{value:"image",label:"Image"},{value:"video",label:"Video"}],[E,C]=(0,t.useState)(null),[I,O]=(0,t.useState)(null),[q,U]=(0,t.useState)(null),[F,T]=(0,t.useState)((null==p?void 0:p.type)||"image"),A=e=>{var l;let a=null===(l=e.target.files)||void 0===l?void 0:l[0];if(a){let l=e.target.name,s=URL.createObjectURL(a);"galleryPhoto"==l&&C(s),"galleryVideoPoster"==l&&U(s)}},L=e=>l=>{var a;e(null!==(a=null==l?void 0:l.value)&&void 0!==a?a:null),T(null==l?void 0:l.value)};return(0,s.jsx)("div",{className:"",children:(0,s.jsxs)("form",{onSubmit:N(e=>{x(e)}),encType:"multipart/form-data",children:[(0,s.jsxs)("div",{className:"mb-3",children:[(0,s.jsx)("label",{htmlFor:"type",className:"form-label",children:"Type *"}),(0,s.jsx)(i.xI,{name:"type",control:P,rules:{required:"Type is required"},render:e=>{let{field:l}=e;return(0,s.jsx)(r.Ay,{...l,options:S,value:S.find(e=>e.value===l.value)||null,onChange:L(l.onChange),placeholder:"Select Type"})}}),V.type&&(0,s.jsx)("small",{className:"text-danger",children:null===(a=V.type)||void 0===a?void 0:null===(l=a.message)||void 0===l?void 0:l.toString()})]}),"image"==F&&(0,s.jsxs)("div",{className:"mb-3",children:[(0,s.jsx)("label",{htmlFor:"image",className:"form-label",children:"Image *"}),(0,s.jsxs)("div",{className:"btn-main-box",children:[(0,s.jsx)("input",{type:"file",className:"file-input",...b("galleryPhoto",{required:!E&&(null==p||!p.image)&&"Image is required"}),onChange:A}),(0,s.jsx)("div",{className:"btn-box",children:"Upload Image"})]}),E&&(0,s.jsx)("img",{src:E,alt:"Image Preview",className:"mt-3",width:100}),!E&&p&&p.image&&(0,s.jsx)("img",{src:n+"/"+p.image,alt:"Image Preview",className:"mt-3",width:100}),!E&&V.galleryPhoto&&(0,s.jsx)("small",{className:"text-danger",children:null===(c=V.galleryPhoto)||void 0===c?void 0:null===(d=c.message)||void 0===d?void 0:d.toString()})]}),(0,s.jsxs)("div",{className:"row",children:["video"==F&&(0,s.jsxs)("div",{className:"mb-3 col-md-4",children:[(0,s.jsx)("label",{className:"form-label",children:"Video"}),(0,s.jsxs)("div",{className:"btn-main-box",children:[(0,s.jsx)("input",{type:"file",className:"file-input",accept:"video/*",...b("galleryVideo",{required:!I&&(null==p||!p.video)&&"Video is required"}),onChange:e=>{var l;let a=null===(l=e.target.files)||void 0===l?void 0:l[0];a&&O(URL.createObjectURL(a))}}),(0,s.jsx)("div",{className:"btn-box",children:"Upload Video"})]}),I&&(0,s.jsx)("div",{className:"video-preview mt-3",children:(0,s.jsx)("video",{src:I,controls:!0,width:320,height:240,className:"rounded shadow-md"})}),!I&&p&&p.video&&(0,s.jsx)("div",{className:"video-preview mt-3",children:(0,s.jsx)("video",{src:n+"/"+p.video,controls:!0,width:320,height:240,className:"rounded shadow-md"})}),!I&&V.galleryVideo&&(0,s.jsx)("small",{className:"text-danger",children:null===(u=V.galleryVideo)||void 0===u?void 0:null===(m=u.message)||void 0===m?void 0:m.toString()})]}),"video"==F&&(0,s.jsxs)("div",{className:"mb-3 col-md-4",children:[(0,s.jsx)("label",{className:"form-label",children:"Poster Image"}),(0,s.jsxs)("div",{className:"btn-main-box",children:[(0,s.jsx)("input",{type:"file",className:"file-input",...b("galleryVideoPoster",{required:!q&&(null==p||!p.videoPoster)&&"Poster is required"}),onChange:A}),(0,s.jsx)("div",{className:"btn-box",children:"Upload Image"})]}),q&&(0,s.jsx)("img",{src:q,alt:"Poster Preview",className:"mt-3",width:100}),!q&&p&&p.videoPoster&&(0,s.jsx)("img",{src:n+"/"+p.videoPoster,alt:"Poster Preview",className:"mt-3",width:100}),!q&&V.galleryVideoPoster&&(0,s.jsx)("small",{className:"text-danger",children:null===(g=V.galleryVideoPoster)||void 0===g?void 0:null===(h=g.message)||void 0===h?void 0:h.toString()})]})]}),(0,s.jsxs)("div",{className:"mb-3",children:[(0,s.jsx)("label",{className:"form-label",children:"Order"}),(0,s.jsx)("input",{type:"number",min:"0",className:"form-control",...b("order",{})}),V.order&&(0,s.jsx)("small",{className:"text-danger",children:null===(y=V.order)||void 0===y?void 0:null===(v=y.message)||void 0===v?void 0:v.toString()})]}),(0,s.jsx)("button",{type:"submit",className:"btn btn-primary me-2",disabled:j,children:j?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Saving..."]}):"Save"}),(0,s.jsx)(o(),{className:"btn btn-outline-secondary ml-2",href:"/admin/gallery/",children:"Cancel"})]})})}}},e=>{var l=l=>e(e.s=l);e.O(0,[5799,6813,2177,3259,5319,8441,1684,7358],()=>l(1771)),_N_E=e.O()}]);